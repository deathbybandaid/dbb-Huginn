{
  "schema_version": 1,
  "name": "CHIEF O'BRIEN AT WORK Scrape Method",
  "description": "No description provided",
  "source_url": false,
  "guid": "811085236b6a574f3633548a4f3f13ff",
  "tag_fg_color": "#ffffff",
  "tag_bg_color": "#5bc0de",
  "icon": "gear",
  "exported_at": "2020-04-08T17:24:35Z",
  "agents": [
    {
      "type": "Agents::DataOutputAgent",
      "name": "CHIEF O'BRIEN AT WORK RSS Output",
      "disabled": false,
      "guid": "08e164888eefc10ba421811f94de2898",
      "options": {
        "secrets": [
          "rssfeed"
        ],
        "expected_receive_period_in_days": 2,
        "template": {
          "title": "CHIEF O'BRIEN AT WORK comics as a feed",
          "description": "This is a feed of recent CHIEF O'BRIEN AT WORK comics, generated by Huginn",
          "item": {
            "title": "{{title}} | {{ pubDate | date: \"%a, %b %d, %Y\" }}",
            "description": "<img src=\"{{img}}\"; style=\"max-width: 350px; float:left \">{{title}}",
            "link": "{{url}}",
            "pubDate": "{{pubDate}}",
            "id": "{{url}}"
          },
          "link": "https://chiefobrienatwork.com"
        },
        "ns_media": "true",
        "events_to_show": "9999999"
      },
      "propagate_immediately": true
    },
    {
      "type": "Agents::JavaScriptAgent",
      "name": "CHIEF O'BRIEN AT WORK Current",
      "disabled": false,
      "guid": "58453c52c0f1365b8117103ffe4ab50e",
      "options": {
        "language": "JavaScript",
        "code": "function urlformatter(inputyear, inputmonth){\r\n  var url = \"https://chiefobrienatwork.com/archive/\" + (inputyear).toString() + \"/\" + (inputmonth).toString()\r\n  return url;\r\n}\r\n\r\nAgent.check = function() {\r\n  var currentYear = new Date().getFullYear();\r\n  var currentMonth = new Date().getMonth();\r\n  var dateurl = urlformatter(currentYear, currentMonth)\r\n  this.createEvent(\r\n    {\r\n      'year': currentYear,\r\n      'month': currentMonth,\r\n      'dateurl': dateurl,\r\n    });\r\n};",
        "expected_receive_period_in_days": "2",
        "expected_update_period_in_days": "2"
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::JavaScriptAgent",
      "name": "CHIEF O'BRIEN AT WORK Backfill Date Range",
      "disabled": false,
      "guid": "759e0612c6cf45fb5ba82c4e40487f11",
      "options": {
        "language": "JavaScript",
        "code": "function yearslist(startYear, endYear){\r\n  var years = []\r\n  for(var i=startYear;i<=endYear;i++){\r\n      years.push(i);\r\n  } \r\n  return years;\r\n}\r\n\r\nfunction monthslist(startMonth, endMonth){\r\n  var months = []\r\n  for(var i=startMonth;i<=endMonth;i++){\r\n      months.push(i);\r\n  } \r\n  return months;\r\n}\r\n\r\nfunction urlformatter(inputyear, inputmonth){\r\n  var url = \"https://chiefobrienatwork.com/archive/\" + (inputyear).toString() + \"/\" + (inputmonth).toString()\r\n  return url;\r\n}\r\n\r\nAgent.check = function() {\r\n  var currentYear = new Date().getFullYear();\r\n  var currentMonth = new Date().getMonth();\r\n  var yearlist = yearslist(2014, currentYear)\r\n  for (yearindex = 0; yearindex < yearlist.length; yearindex++) {\r\n    var indexyear = yearlist[yearindex]\r\n    if (indexyear == 2014) {\r\n      var monthslist = [12]\r\n    } else if (indexyear == currentYear) {\r\n      var monthslist = yearslist(1, currentMonth+1)\r\n    } else {\r\n      var monthslist = yearslist(1, 12)\r\n    }\r\n    for (monthindex = 0; monthindex < monthslist.length; monthindex++) {\r\n      var indexmonth = monthslist[monthindex]\r\n      var dateurl = urlformatter(indexyear, indexmonth)\r\n      this.createEvent(\r\n        {\r\n          'year': indexyear,\r\n          'month': indexmonth,\r\n          'dateurl': dateurl,\r\n        });\r\n    }\r\n  }\r\n};",
        "expected_receive_period_in_days": "2",
        "expected_update_period_in_days": "2"
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": false
    },
    {
      "type": "Agents::WebsiteAgent",
      "name": "CHIEF O'BRIEN AT WORK Comic URL Scraper",
      "disabled": false,
      "guid": "8f74469e14440c4d186be7686eafb108",
      "options": {
        "expected_update_period_in_days": "2",
        "url": "{{url}}",
        "type": "html",
        "mode": "on_change",
        "extract": {
          "imgurl": {
            "css": ".P > a:nth-child(1)",
            "value": "@href"
          },
          "title": {
            "css": ".captions > p:nth-child(1)",
            "value": "string(.)"
          }
        },
        "template": {
          "url": "{{comicurl}}",
          "pubDate": "{{pubDate}}"
        }
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::WebsiteAgent",
      "name": "CHIEF O'BRIEN AT WORK Date Scraper",
      "disabled": false,
      "guid": "a119960a8a1bed51285ab2dc4a6171e0",
      "options": {
        "expected_update_period_in_days": "2",
        "url": "{{url}}",
        "type": "html",
        "mode": "on_change",
        "extract": {
          "url": {
            "css": "#base-container > div._1VWa_ > div._2u2xA > div:nth-child(1) > div > div:nth-child(n) > div > a",
            "value": "@href"
          },
          "pubDate": {
            "css": "#base-container > div._1VWa_ > div._2u2xA > div:nth-child(1) > div > div:nth-child(n) > div > a > div.SOOWB > h1",
            "value": "string(.)"
          }
        },
        "template": {
          "pubDate": "{{pubDate | date: \"%Y-%m-%d %H:%M\"}}",
          "comicurl": "{{url}}"
        }
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::PhantomJsCloudAgent",
      "name": "CHIEF O'BRIEN AT WORK DateRange Phantom URL",
      "disabled": false,
      "guid": "d085d9bfff1106b95e030f355f7c9a72",
      "options": {
        "mode": "merge",
        "api_key": "{% credential phantomjscloud_api_key %}",
        "url": "{{dateurl}}",
        "render_type": "html",
        "output_as_json_radio": "false",
        "output_as_json": "false",
        "ignore_images_radio": "false",
        "ignore_images": "false",
        "user_agent": "Mozilla/5.0 (BlackBerry; U; BlackBerry 9900; en) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.1.0.346 Mobile Safari/534.11+",
        "wait_interval": "1000"
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::WebsiteAgent",
      "name": "CHIEF O'BRIEN AT WORK Comic HD Image Scraper",
      "disabled": false,
      "guid": "d4458524e7adfc09df084ad31e831a6e",
      "options": {
        "expected_update_period_in_days": "2",
        "url": "{{imgurl}}",
        "type": "html",
        "mode": "on_change",
        "extract": {
          "img": {
            "css": "#base-container > div.dnZGw > main > button > span > img",
            "value": "@srcset"
          }
        },
        "template": {
          "url": "{{url}}",
          "title": "{{title}}",
          "pubDate": "{{pubDate}}",
          "img": "{{ img | split: \",\" | last | split: \" \" | first}}"
        }
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::RssAgent",
      "name": "CHIEF O'BRIEN AT WORK Scrape Method RSS Trigger",
      "disabled": false,
      "guid": "fd5abb90e5479cead1a031cfc7d27f56",
      "options": {
        "expected_update_period_in_days": "5",
        "clean": "false",
        "url": "https://chiefobrienatwork.com/rss#_=_"
      },
      "schedule": "every_30m",
      "keep_events_for": 0
    }
  ],
  "links": [
    {
      "source": 1,
      "receiver": 5
    },
    {
      "source": 2,
      "receiver": 5
    },
    {
      "source": 3,
      "receiver": 6
    },
    {
      "source": 4,
      "receiver": 3
    },
    {
      "source": 5,
      "receiver": 4
    },
    {
      "source": 6,
      "receiver": 0
    },
    {
      "source": 7,
      "receiver": 1
    }
  ],
  "control_links": [

  ]
}