{
  "schema_version": 1,
  "name": "Truth in IT Webinars",
  "description": "No description provided",
  "source_url": false,
  "guid": "16da08bda217aa0e352c2faaa4ab6c6a",
  "tag_fg_color": "#ffffff",
  "tag_bg_color": "#5bc0de",
  "icon": "gear",
  "exported_at": "2020-04-03T17:53:01Z",
  "agents": [
    {
      "type": "Agents::WebsiteAgent",
      "name": "Truth in IT Event Fetcher",
      "disabled": false,
      "guid": "1f23660269c3d86063eb432f4fefd3ec",
      "options": {
        "expected_update_period_in_days": "2",
        "url": "https://www.truthinit.com/index.php/events/",
        "type": "html",
        "mode": "on_change",
        "extract": {
          "url": {
            "css": "body > div.pageWrapper > section > div.pageBodyWrapper > div > div > div.column.sideColumn.topSpace > aside > div > div:nth-child(2) > div.widgetContent > div > ul > li:nth-child(n) > div.text > h4 > a",
            "value": "@href"
          },
          "title": {
            "css": "body > div.pageWrapper > section > div.pageBodyWrapper > div > div > div.column.sideColumn.topSpace > aside > div > div:nth-child(2) > div.widgetContent > div > ul > li:nth-child(n) > div.text > h4 > a",
            "value": "string(.)"
          }
        }
      },
      "schedule": "every_1h",
      "keep_events_for": 0,
      "propagate_immediately": false
    },
    {
      "type": "Agents::WebsiteAgent",
      "name": "Truth in IT Event Parser",
      "disabled": false,
      "guid": "50e54f4db6b898d14a2b072b71812323",
      "options": {
        "expected_update_period_in_days": "2",
        "url": "{{url}}",
        "type": "html",
        "mode": "on_change",
        "extract": {
          "body": {
            "css": "body > div.pageWrapper > section > div.pageBodyWrapper > div > div > div.column.mainColumn.topSpace > section > div > div:nth-child(1) > div:nth-child(2)",
            "value": "string(.)"
          },
          "timestamp": {
            "css": "body > div.pageWrapper > section > div.pageBodyWrapper > div > div > div.column.mainColumn.topSpace > section > div > div:nth-child(1) > div.mainHeadingWrapper.newsEventHeading.inside > div.mainHeading > div.publishInfo.dim > div.date",
            "value": "string(.)"
          }
        },
        "template": {
          "url": "{{url}}",
          "timestamp": "{{timestamp  | split: \" - \" | first | split: \" \" | first | split: \"/\" | last}}-{{timestamp  | split: \" - \" | first | split: \" \" | first | split: \"/\" | first}}-{{timestamp  | split: \" - \" | first | split: \" \" | first | replace_first: \"/\", \"\\\" | split: \"\\\" | last | split: \"/\" | first}} {{timestamp  | split: \" - \" | first | split: \" \" | last  | date: \"%H:%M\"}}",
          "body": "{{body }}{% line_break %}{% line_break %}{{url}}",
          "title": "{{title}}"
        }
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::GoogleCalendarPublishAgent",
      "name": "Truth in IT Google Calendar Post",
      "disabled": false,
      "guid": "97b492351af89165a608bc94b30728f8",
      "options": {
        "expected_update_period_in_days": "10",
        "calendar_id": "{% credential google_calendar_id_truthinit%}",
        "google": {
          "service_account_email": "{% credential google_api_service_email %}",
          "key_file": "/home/huginn/huginn-google_api.json"
        }
      },
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::DataOutputAgent",
      "name": "Truth in IT Webinar RSS Output",
      "disabled": false,
      "guid": "b0571380ba93ec2ba7eca509a33c230f",
      "options": {
        "secrets": [
          "rssfeed"
        ],
        "expected_receive_period_in_days": 2,
        "template": {
          "title": "Truth in IT New Webinars as a feed",
          "description": "This is a feed of recently added Truth in IT Webinars, generated by Huginn",
          "item": {
            "title": "{{title}} | {{ timestamp | date: \"%Y-%m-%d %H:%M\" }}",
            "description": "{{body}}",
            "link": "{{url}}",
            "pubDate": "{{timestamp }}",
            "id": "{{url}}"
          },
          "link": "https://www.truthinit.com/"
        },
        "ns_media": "true"
      },
      "propagate_immediately": true
    },
    {
      "type": "Agents::EventFormattingAgent",
      "name": "Truth in IT Webinar RFC 3339",
      "disabled": false,
      "guid": "dae3cac5e3d058f0a268646df1dd5791",
      "options": {
        "instructions": {
          "timestamp": "{{ timestamp | date: \"%Y-%m-%d %H:%M\" }}",
          "year": "{{ timestamp | date: \"%Y\" }}",
          "month": "{{ timestamp | date: \"%m\" }}",
          "day": "{{ timestamp | date: \"%d\" }}",
          "hour_start": "{{ timestamp | date: \"%H\" }}",
          "hour_end": "{{ timestamp | date: \"%H\" | plus: 1 }}",
          "minute": "{{ timestamp | date: \"%M\" }}"
        },
        "matchers": [

        ],
        "mode": "merge"
      },
      "keep_events_for": 0,
      "propagate_immediately": true
    },
    {
      "type": "Agents::JavaScriptAgent",
      "name": "Truth in IT Webinar GCal Paylod Formatter",
      "disabled": false,
      "guid": "f1d49922d636f6e099bd9392d9b2e84b",
      "options": {
        "language": "JavaScript",
        "code": "function ISODateString(d){\r\n function pad(n){return n<10 ? '0'+n : n}\r\n return d.getUTCFullYear()+'-'\r\n      + pad(d.getUTCMonth())+'-'\r\n      + pad(d.getUTCDate())+'T'\r\n      + pad(d.getUTCHours())+':'\r\n      + pad(d.getUTCMinutes())+':'\r\n      + pad(d.getUTCSeconds())+'Z'}\r\n\r\nAgent.receive = function() { \r\n   var events = this.incomingEvents();\r\n   for(var i = 0; i < events.length; i++) {\r\n    var body = events[i].payload['body']\r\n    var summary = events[i].payload['title']\r\n    var germanDate = body.match(/\\w+, (\\d+). (\\w+) (\\d+)/)\r\n    var year = events[i].payload['year']\r\n    var month = events[i].payload['month']\r\n    var day = events[i].payload['day']\r\n    var hour_start = events[i].payload['hour_start']\r\n    var hour_end = events[i].payload['hour_end']\r\n    var minute = events[i].payload['minute']\r\n    var startDate = new Date(year, month, day, hour_start, minute, 0, 0)\r\n    var endDate = new Date(year, month, day, hour_end, minute, 0, 0)\r\n    \r\n    this.createEvent(\r\n      { 'message': \r\n        { 'summary': summary,\r\n          'visibility': 'default',\r\n          'description': body,\r\n          'start': {\r\n           'dateTime': ISODateString(startDate)\r\n          },\r\n          'end': {\r\n            'dateTime': ISODateString(endDate)\r\n          }\r\n        }\r\n      }\r\n    );\r\n  }\r\n}",
        "expected_receive_period_in_days": "2",
        "expected_update_period_in_days": "2"
      },
      "schedule": "never",
      "keep_events_for": 0,
      "propagate_immediately": true
    }
  ],
  "links": [
    {
      "source": 0,
      "receiver": 1
    },
    {
      "source": 1,
      "receiver": 4
    },
    {
      "source": 1,
      "receiver": 3
    },
    {
      "source": 4,
      "receiver": 5
    },
    {
      "source": 5,
      "receiver": 2
    }
  ],
  "control_links": [

  ]
}
